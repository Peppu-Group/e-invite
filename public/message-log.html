<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message Status Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.prod.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        #app {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .upload-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        .upload-group {
            margin-bottom: 20px;
        }
        
        .upload-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 1.1em;
        }
        
        .file-input {
            display: block;
            width: 100%;
            padding: 12px;
            border: 2px dashed #667eea;
            border-radius: 8px;
            background: #f8f9ff;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-input:hover {
            border-color: #764ba2;
            background: #f0f2ff;
        }
        
        .process-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 10px;
        }
        
        .process-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .process-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-card h3 {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        
        .stat-card .number {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
        }
        
        .results-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .search-box {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 20px;
            transition: border-color 0.3s;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
        }
        
        th {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 0.5px;
        }
        
        tbody tr {
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
        }
        
        tbody tr:hover {
            background-color: #f8f9ff;
        }
        
        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-sent {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .status-delivered {
            background: #fff3e0;
            color: #f57c00;
        }
        
        .status-read {
            background: #e8f5e9;
            color: #388e3c;
        }
        
        .status-failed {
            background: #ffebee;
            color: #d32f2f;
        }
        
        .status-unknown {
            background: #f5f5f5;
            color: #757575;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 1.2em;
        }
        
        .error {
            background: #ffebee;
            color: #d32f2f;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <h1>📊 Message Status Dashboard</h1>
            <p>Track and monitor message delivery status</p>
        </div>
        
        <div v-if="error" class="error">{{ error }}</div>
        
        <div v-if="results.length > 0" class="stats">
            <div class="stat-card">
                <h3>Total Messages</h3>
                <div class="number">{{ results.length }}</div>
            </div>
            <div class="stat-card">
                <h3>Read</h3>
                <div class="number" style="color: #388e3c;">{{ statusCounts.read }}</div>
            </div>
            <div class="stat-card">
                <h3>Delivered</h3>
                <div class="number" style="color: #f57c00;">{{ statusCounts.delivered }}</div>
            </div>
            <div class="stat-card">
                <h3>Sent</h3>
                <div class="number" style="color: #1976d2;">{{ statusCounts.sent }}</div>
            </div>
            <div class="stat-card">
                <h3>Failed</h3>
                <div class="number" style="color: #d32f2f;">{{ statusCounts.failed }}</div>
            </div>
            <div class="stat-card">
                <h3>Unknown</h3>
                <div class="number" style="color: #757575;">{{ statusCounts.unknown }}</div>
            </div>
        </div>
        
        <div v-if="results.length > 0" class="results-section">
            <input 
                type="text" 
                class="search-box" 
                v-model="searchQuery" 
                placeholder="🔍 Search by name, phone, or message ID...">
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Message ID</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="result in filteredResults" :key="result.messageId">
                            <td>{{ result.name }}</td>
                            <td>{{ result.phone }}</td>
                            <td style="font-family: monospace; font-size: 0.85em;">{{ result.messageId }}</td>
                            <td>
                                <span :class="'status-badge status-' + result.status.toLowerCase()">
                                    {{ result.status }}
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div v-if="!processing && results.length === 0 && !error" class="results-section">
            <div class="empty-state">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                </svg>
                <h3>No Data Yet</h3>
                <p>Upload your CSV and log files to get started</p>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    csvData: null,
                    logData: null,
                    results: [],
                    searchQuery: '',
                    processing: false,
                    error: null,
                    // Hardcoded CSV data - replace with your actual data
                    hardcodedCSV: `name,phone,id,last5Digits,status,messageId,timestamp,last9Digits
"SEN. GODSWILL AKPABIO, GCON",2349090001829,90001829,90001829,SUCCESS,wamid.HBgNMjM0OTA5MDAwMTgyORUCABEYEjA4NkE4MTA5MEZDODRDNkU1MgA=,2025-10-09T22:14:01.133Z,090001829
SEN. BARAU IBRAHIM JIBRIN,2349076092406,76092406,76092406,SUCCESS,wamid.HBgNMjM0OTA3NjA5MjQwNhUCABEYEjA0Nzg1RDNCRTkyMDZEQzRGRAA=,2025-10-09T22:14:02.632Z,076092406
SEN. OPEYEMI BAMIDELE Senate Majority Leader,2348091111234,91111234,91111234,SUCCESS,wamid.HBgNMjM0ODA5MTExMTIzNBUCABEYEkMyQUU2MkRBQzE1MUUyNDQ1RgA=,2025-10-09T22:14:05.666Z,091111234
SEN. MONGUNO MOHAMMED TAHIR. Chief Whip,2347053173540,53173540,53173540,SUCCESS,wamid.HBgNMjM0NzA1MzE3MzU0MBUCABEYEkEwQzRDRDQ3MkI4RDREQUQwRgA=,2025-10-09T22:14:07.604Z,053173540
SEN. YISA ASHIRU OYELOLA Deputy Senate Leader,2347055221111,55221111,55221111,SUCCESS,wamid.HBgNMjM0NzA1NTIyMTExMRUCABEYEkFFQzI2QjMzRjBGOEMxMTIzOQA=,2025-10-09T22:14:09.087Z,055221111
SEN. NWEBONYI ONYEKACHI PETER. Deputy Chief Whip,2348030916245,30916245,30916245,SUCCESS,wamid.HBgNMjM0ODAzMDkxNjI0NRUCABEYEkNCQkExNUIwMzgzNURGQUE3OAA=,2025-10-09T22:14:10.728Z,030916245
SEN. NGWU OSITA Senate Minority Whip,2348091111978,91111978,91111978,SUCCESS,wamid.HBgNMjM0ODA5MTExMTk3OBUCABEYEkFENEYzNDZCRjU1RUYyRDhGQQA=,2025-10-09T22:14:14.209Z,091111978
SEN. ABARIBE ENYINNAYA HARCOURT,2348033129452,33129452,33129452,SUCCESS,wamid.HBgNMjM0ODAzMzEyOTQ1MhUCABEYEkJDQzQ0NDgyRTVFNkQ2OEI5RAA=,2025-10-09T22:14:15.788Z,033129452
⁠SEN. KALU ORJI UZOR,2348034000001,34000001,34000001,SUCCESS,wamid.HBgNMjM0ODAzNDAwMDAwMRUCABEYEkU0MkFEQTVERjg3MzQwNzkyRAA=,2025-10-09T22:14:17.283Z,034000001
SEN. AKOBUNDU AUSTIN OKWUDIRI,2348033092573,33092573,33092573,SUCCESS,wamid.HBgNMjM0ODAzMzA5MjU3MxUCABEYEjJFRDRGNTUxOUQyNjZDRTVDRQA=,2025-10-09T22:14:18.828Z,033092573
SEN. ABBAS AMINU,2348033210226,33210226,33210226,SUCCESS,wamid.HBgNMjM0ODAzMzIxMDIyNhUCABEYEjU3MzREQzg0NzI4QUQ0MUFERgA=,2025-10-09T22:14:20.419Z,033210226
⁠SEN. ETIM BASSEY ANIEKAN,2348023100921,23100921,23100921,SUCCESS,wamid.HBgNMjM0ODAyMzEwMDkyMRUCABEYEkY0MTE0NzQwNjE4QjlEQUQwMQA=,2025-10-09T22:14:21.954Z,023100921
SEN. UMEH VICTOR CHUKWUNONYELU,2348029695757,29695757,29695757,SUCCESS,wamid.HBgNMjM0ODAyOTY5NTc1NxUCABEYEjEzMjc0OTVCNjg2Qjk4QjA5OQA=,2025-10-09T22:14:23.435Z,029695757
SEN. NWOYE TONY,2348173327148,173327148,173327148,SUCCESS,wamid.HBgNMjM0ODE3MzMyNzE0OBUCABEYEjQ0OEFGNDkzNDc3MzkxQzA4QQA=,2025-10-09T22:14:24.917Z,173327148
⁠SEN. AHMED ABDUL NINGI,2348037875703,37875703,37875703,SUCCESS,wamid.HBgNMjM0ODAzNzg3NTcwMxUCABEYEkFEMUQ0OERENDc2ODNCNTdGNAA=,2025-10-09T22:14:26.619Z,037875703
⁠SEN. KAILA SAMAILA DAHUWA,2348033139423,33139423,33139423,SUCCESS,wamid.HBgNMjM0ODAzMzEzOTQyMxUCABEYEkUzOERBNzRDMzRFQjU4MzFCNQA=,2025-10-09T22:14:28.210Z,033139423
SEN. DICKSON SERIAKE HENRY,2348134994660,134994660,134994660,SUCCESS,wamid.HBgNMjM0ODEzNDk5NDY2MBUCABEYEkM1RjcwMTk5NjBGRjVDQUE2MwA=,2025-10-09T22:14:29.756Z,134994660
⁠SEN. KONBOWEI BENSON FRIDAY,2347035060155,35060155,35060155,SUCCESS,wamid.HBgNMjM0NzAzNTA2MDE1NRUCABEYEkY5QzY1OEUwMTUzNDY1QUFFRAA=,2025-10-09T22:14:31.406Z,035060155
SEN. AGADAGA BENSON SUNDAY,2348080934404,80934404,80934404,SUCCESS,wamid.HBgNMjM0ODA4MDkzNDQwNBUCABEYEjY0NDJGMjZGNDA3RUFCQTk3OQA=,2025-10-09T22:14:32.932Z,080934404
SEN. EMMANUEL UDENDE MEMGA,2348036111345,36111345,36111345,SUCCESS,wamid.HBgNMjM0ODAzNjExMTM0NRUCABEYEkM5Q0NENEU0OTM4RDNDREM3NwA=,2025-10-09T22:14:34.437Z,036111345
SEN. ZAM TITUS TARTENGER,2348036153269,36153269,36153269,SUCCESS,wamid.HBgNMjM0ODAzNjE1MzI2ORUCABEYEkQ0MkU5REQyMjg3NTgxQ0RCMQA=,2025-10-09T22:14:35.891Z,036153269
SEN. KAKA SHEHU LAWAL,2348033031845,33031845,33031845,SUCCESS,wamid.HBgNMjM0ODAzMzAzMTg0NRUCABEYEkRBMjc3MTA1QTVDNzhFNzJFRQA=,2025-10-09T22:14:37.427Z,033031845
SEN. JARIGBE AGOM JARIGBE,2348065276817,65276817,65276817,SUCCESS,wamid.HBgNMjM0ODA2NTI3NjgxNxUCABEYEjY1RkVCOUYyQTM4NDE0MDM4RgA=,2025-10-09T22:14:39.890Z,065276817
⁠SEN. JONAH WILLIAMS ETENG,2348033039120,33039120,33039120,SUCCESS,wamid.HBgNMjM0ODAzMzAzOTEyMBUCABEYEjRCOTFBQ0VEOUNGRUYwQjU2MwA=,2025-10-09T22:14:41.428Z,033039120
⁠SEN. ASUQUO EKPENYONG,2348039742021,39742021,39742021,SUCCESS,wamid.HBgNMjM0ODAzOTc0MjAyMRUCABEYEjE5N0U1QzZDRUZDQUFBRjU3MgA=,2025-10-09T22:14:42.929Z,039742021
⁠SEN. EDE OMUEYA DAFINONE,2348033033885,33033885,33033885,SUCCESS,wamid.HBgNMjM0ODAzMzAzMzg4NRUCABEYEkI3MTVDRDhFMjBFMkMzRTFBNwA=,2025-10-09T22:14:44.533Z,033033885
SEN. JOEL ONOWAKPO THOMAS,2348022233571,22233571,22233571,SUCCESS,wamid.HBgNMjM0ODAyMjIzMzU3MRUCABEYEjg0RTk4REIwRTJENUFEQ0EyRgA=,2025-10-09T22:14:46.071Z,022233571
⁠SEN. NWOKO CHINEDU MUNIR,2348037227010,37227010,37227010,SUCCESS,wamid.HBgNMjM0ODAzNzIyNzAxMBUCABEYEkNEOTdEMzM1RDQ4N0YzRUQ0QwA=,2025-10-09T22:14:47.633Z,037227010
⁠SEN. ANI ANTHONY OKORIE,2348036794572,36794572,36794572,SUCCESS,wamid.HBgNMjM0ODAzNjc5NDU3MhUCABEYEkI2MzlGNjc3RkRCQUQ1RTRCNAA=,2025-10-09T22:14:49.118Z,036794572
SEN. EZE KENNETH EMEKA,2347034443573,34443573,34443573,SUCCESS,wamid.HBgNMjM0NzAzNDQ0MzU3MxUCABEYEjBEQTYwNEI0RTcxRUNDMDMyMAA=,2025-10-09T22:14:50.616Z,034443573
SEN. OSHIOMAHOLE ADAMS ALIYU,2349122222227,122222227,122222227,SUCCESS,wamid.HBgNMjM0OTEyMjIyMjIyNxUCABEYEjFBNDk1MTY0RUFEQzk4RDg2OQA=,2025-10-09T22:14:52.108Z,122222227
⁠SEN. IMASUEN NEDA BERNARDS,2348038679575,38679575,38679575,SUCCESS,wamid.HBgNMjM0ODAzODY3OTU3NRUCABEYEjdCOUMyMDhBMEM5MjJDQzI0NgA=,2025-10-09T22:14:53.680Z,038679575
⁠SEN. ADARAMODU ADEYEMI,2348035019919,35019919,35019919,SUCCESS,wamid.HBgNMjM0ODAzNTAxOTkxORUCABEYEkU1N0ZFNjJDRThCRDJDQzk2QgA=,2025-10-09T22:14:55.267Z,035019919
⁠SEN. OLUWOLE FASUYI CYRIL,2347062704655,62704655,62704655,SUCCESS,wamid.HBgNMjM0NzA2MjcwNDY1NRUCABEYEjAxMzY1Q0NBNjIxMThCOUVBOAA=,2025-10-09T22:14:56.873Z,062704655
SEN.  CHUKWU CHIZOBA KELVIN,2348035855004,35855004,35855004,SUCCESS,wamid.HBgNMjM0ODAzNTg1NTAwNBUCABEYEkM4ODk2OTFENEQ5QjY3OTQ1RQA=,2025-10-09T22:14:58.369Z,035855004
SEN. OKECHUKWU EZEA,2348057253459,57253459,57253459,SUCCESS,wamid.HBgNMjM0ODA1NzI1MzQ1ORUCABEYEjc3Q0UzNUVCRjI1RjhBRjg3RAA=,2025-10-09T22:14:59.857Z,057253459
SEN. DANKWAMBO IBRAHIM HASSAN,2348035889197,35889197,35889197,SUCCESS,wamid.HBgNMjM0ODAzNTg4OTE5NxUCABEYEjc5QzY4OEUyODc1NzgxNjNCNAA=,2025-10-09T22:15:01.502Z,035889197
⁠⁠SEN. SIYAKO YARO ANTHONY,2348034255742,34255742,34255742,SUCCESS,wamid.HBgNMjM0ODAzNDI1NTc0MhUCABEYEjAwRTNCNjdFRDQ4RUU0RkIyQwA=,2025-10-09T22:15:03.198Z,034255742
SEN. IZUNASO OSITA BONAVENTURE,2348037880727,37880727,37880727,SUCCESS,wamid.HBgNMjM0ODAzNzg4MDcyNxUCABEYEjE0RDBBQTY0M0RCQkJEQjREQwA=,2025-10-09T22:15:04.754Z,037880727
SEN. ONYEWUCHI EZENWA FRANCIS,2348032012132,32012132,32012132,SUCCESS,wamid.HBgNMjM0ODAzMjAxMjEzMhUCABEYEjQ5RDlBODEzQjU3QjVEQTc1NQA=,2025-10-09T22:15:06.349Z,032012132
SEN. NDUBUEZE CHIWUBA PATRICK,2348033734008,33734008,33734008,SUCCESS,wamid.HBgNMjM0ODAzMzczNDAwOBUCABEYEjlDMEI1MUZFM0RENkFBQzRFOQA=,2025-10-09T22:15:08.064Z,033734008
SEN. ABDULHAMID MALLAM-MADORI AHMED,2348037171283,37171283,37171283,SUCCESS,wamid.HBgNMjM0ODAzNzE3MTI4MxUCABEYEkY4Q0Y3QkI1NzREQzA3OTFGOQA=,2025-10-09T22:15:09.722Z,037171283
⁠SEN. KHALID IBRAHIM MUSTAPHA,2348091133066,91133066,91133066,SUCCESS,wamid.HBgNMjM0ODA5MTEzMzA2NhUCABEYEkQzOUZFQjBDMUI3QUIxNjlGRAA=,2025-10-09T22:15:11.356Z,091133066
⁠SEN. KATUNG SUNDAY MARSHALL,2348094446444,94446444,94446444,SUCCESS,wamid.HBgNMjM0ODA5NDQ0NjQ0NBUCABEYEkQ0MTJCREZBRDVBQkU0QjRGOAA=,2025-10-09T22:15:13.095Z,094446444
⁠SEN. USMAN LAWAL ADAMU,2349030469204,30469204,30469204,SUCCESS,wamid.HBgNMjM0OTAzMDQ2OTIwNBUCABEYEjQ3MkFCOEFBQTMzOEI0MTREOAA=,2025-10-09T22:15:14.861Z,030469204
SEN. KAWU SUMAILA ABDURRAMAN,2348039206959,39206959,39206959,SUCCESS,wamid.HBgNMjM0ODAzOTIwNjk1ORUCABEYEjk2QjYwRjNDNTA0QUE0NUEwNAA=,2025-10-09T22:15:16.368Z,039206959
SEN. YAR’ADUA ABDULAZIZ MUSA,2348030851223,30851223,30851223,SUCCESS,wamid.HBgNMjM0ODAzMDg1MTIyMxUCABEYEkM4RkIyNTBDQjY4MDkxRDIwRAA=,2025-10-09T22:15:17.852Z,030851223
⁠SEN. NASIRU SANI ZANGON DAURA,2347088881500,88881500,88881500,SUCCESS,wamid.HBgNMjM0NzA4ODg4MTUwMBUCABEYEkVFNkJBQTgxNUVFMkJBMkJBMQA=,2025-10-09T22:15:19.480Z,088881500
SEN. ABDULLAHI YAHAYA ABUBAKAR,2348155093939,155093939,155093939,SUCCESS,wamid.HBgNMjM0ODE1NTA5MzkzORUCABEYEjFFRkQxMjk2MzJFM0ZBNzhBQQA=,2025-10-09T22:15:21.259Z,155093939
⁠SEN. ALIERO ADAMU MOHAMMED,2347066847000,66847000,66847000,SUCCESS,wamid.HBgNMjM0NzA2Njg0NzAwMBUCABEYEjg4N0FBNTREQURDMTIyQTU2NwA=,2025-10-09T22:15:22.984Z,066847000
⁠SEN. GARBA MUSA MAIDOKI,2348034477173,34477173,34477173,SUCCESS,wamid.HBgNMjM0ODAzNDQ3NzE3MxUCABEYEjQ2NkJGNENDRUU2NDVCN0U0QgA=,2025-10-09T22:15:24.709Z,034477173
SEN. JIBRIN ISAH,2348054655384,54655384,54655384,SUCCESS,wamid.HBgNMjM0ODA1NDY1NTM4NBUCABEYEkE0OTc0MjdFNjQyOUMxQTYxNAA=,2025-10-09T22:15:26.269Z,054655384
⁠SEN. KARIMI SUNDAY STEVE,2348033146617,33146617,33146617,SUCCESS,wamid.HBgNMjM0ODAzMzE0NjYxNxUCABEYEjc0QzQ1MTYwOTA5NEZEMDlFMAA=,2025-10-09T22:15:29.092Z,033146617
⁠SEN. SULEIMAN UMAR SADIQ,2348038829798,38829798,38829798,SUCCESS,wamid.HBgNMjM0ODAzODgyOTc5OBUCABEYEjc5OEQyNDNFRDk0OTQwQTUzMwA=,2025-10-09T22:15:30.783Z,038829798
SEN. SALIU MUSTAPHA,2348033584659,33584659,33584659,SUCCESS,wamid.HBgNMjM0ODAzMzU4NDY1ORUCABEYEjBEMTRFNEJGOTdEQzFFQjE2QwA=,2025-10-09T22:15:32.460Z,033584659
SEN ABIRU MUKHAIL ADETOKUNBO,2348022901922,22901922,22901922,SUCCESS,wamid.HBgNMjM0ODAyMjkwMTkyMhUCABEYEkU2RTNFQkVEQ0UxRDMzODU5MAA=,2025-10-09T22:15:33.947Z,022901922
⁠SEN. ESHILOKUN SANNI WASIU,2348022234871,22234871,22234871,SUCCESS,wamid.HBgNMjM0ODAyMjIzNDg3MRUCABEYEjAyRTREMTRDMkFGNzQ5MUZBNgA=,2025-10-09T22:15:35.725Z,022234871
⁠SEN. ADEBULE IDIAT OLURANTI,2348033317265,33317265,33317265,SUCCESS,wamid.HBgNMjM0ODAzMzMxNzI2NRUCABEYEjBCRDE4NEJEMTNFQjBFRDg3MwA=,2025-10-09T22:15:37.313Z,033317265
⁠SEN. AKWASHIKI GODIYA,2348099321703,99321703,99321703,SUCCESS,wamid.HBgNMjM0ODA5OTMyMTcwMxUCABEYEjU4RDE2N0Q4NUM5NzM5QUE0QgA=,2025-10-09T22:15:39.678Z,099321703
SEN. OGOSHI ONAWO MOHAMMED,2349080001952,80001952,80001952,SUCCESS,wamid.HBgNMjM0OTA4MDAwMTk1MhUCABEYEjQ5REEyODgyMDYxNzA4NDAyMAA=,2025-10-09T22:15:41.318Z,080001952
SEN. ALIYU WADADA AHMED,447788805066,788805066,788805066,SUCCESS,wamid.HBgMNDQ3Nzg4ODA1MDY2FQIAERgSQkRCOEFFQkI5REJGNzI1RUM5AA==,2025-10-09T22:15:42.854Z,788805066
⁠SEN. MUSA MOHAMMED SANI,2348033114615,33114615,33114615,SUCCESS,wamid.HBgNMjM0ODAzMzExNDYxNRUCABEYEjI2NkNCRjdEOERCM0UxNDhBQQA=,2025-10-09T22:15:44.397Z,033114615
SEN. JIYA PETER NDALIKALI,2348034515939,34515939,34515939,SUCCESS,wamid.HBgNMjM0ODAzNDUxNTkzORUCABEYEkJBNkY4QzQ4ODYzRUE3RThCNwA=,2025-10-09T22:15:45.866Z,034515939
SEN. BELLO SANI ABUBAKAR,2348175599064,175599064,175599064,SUCCESS,wamid.HBgNMjM0ODE3NTU5OTA2NBUCABEYEjUzNzFCRDUyN0Y3N0ZBNjc1QwA=,2025-10-09T22:15:47.490Z,175599064
SEN. OLAMILEKAN ADEOLA SOLOMON,2349030001319,30001319,30001319,SUCCESS,wamid.HBgNMjM0OTAzMDAwMTMxORUCABEYEjlDOEQxNEUwN0Y3MDU2MDhCRgA=,2025-10-09T22:15:48.998Z,030001319
SEN. DANIEL OLUGBENGA JUSTUS,2348037470001,37470001,37470001,SUCCESS,wamid.HBgNMjM0ODAzNzQ3MDAwMRUCABEYEkY5MkZEMjc4QkM0NUZBNzNEOQA=,2025-10-09T22:15:50.575Z,037470001
SEN. SALISU SHUAIBU AFOLABI,2348033089635,33089635,33089635,SUCCESS,wamid.HBgNMjM0ODAzMzA4OTYzNRUCABEYEjhFNDUwODRBMUE0MUM2MTYzMAA=,2025-10-09T22:15:52.026Z,033089635
SEN. ADEGBONMIRE ADENIYI AYODELE,2348051271779,51271779,51271779,SUCCESS,wamid.HBgNMjM0ODA1MTI3MTc3ORUCABEYEjA0NDYyMjBDMDI1MDg2RkE1QgA=,2025-10-09T22:15:53.590Z,051271779
SEN. OLAJIDE IPINSAGBA EMMANUEL,2348111789423,111789423,111789423,SUCCESS,wamid.HBgNMjM0ODExMTc4OTQyMxUCABEYEkQ3M0NENENGNUY3NTlDN0ZCNAA=,2025-10-09T22:15:55.288Z,111789423
SEN. JIMOH IBRAHIM FOLORUNSHO,2348059226469,59226469,59226469,SUCCESS,wamid.HBgNMjM0ODA1OTIyNjQ2ORUCABEYEkY3RTcwMDEwRkJGRDMxRDRCMAA=,2025-10-09T22:15:56.975Z,059226469
SEN. FADAHUNSI ADENIGBA FRANCIS,2348052242211,52242211,52242211,SUCCESS,wamid.HBgNMjM0ODA1MjI0MjIxMRUCABEYEkY0REU3QUIwREU1QTk2MkVGOAA=,2025-10-09T22:15:58.499Z,052242211
SEN. OLUBIYI FADEYI OLUWOLE,2348038944446,38944446,38944446,SUCCESS,wamid.HBgNMjM0ODAzODk0NDQ0NhUCABEYEkRDNUExODVCQzVDRDQyOEYzMAA=,2025-10-09T22:16:00.092Z,038944446
SEN. ALI SHARAFADEEN ABIODUN,2348052783149,52783149,52783149,SUCCESS,wamid.HBgNMjM0ODA1Mjc4MzE0ORUCABEYEkVDNjQxMDM3N0U5REFDQzI2OQA=,2025-10-09T22:16:01.608Z,052783149
⁠SEN. AKINTUNDE YUNUS ABIODUN,2348036468888,36468888,36468888,SUCCESS,wamid.HBgNMjM0ODAzNjQ2ODg4OBUCABEYEkM4MzA4QjAxOEZFMEE5RUI5NgA=,2025-10-09T22:16:03.258Z,036468888
⁠SEN. PLANG DIKET SATSO,2348034523759,34523759,34523759,SUCCESS,wamid.HBgNMjM0ODAzNDUyMzc1ORUCABEYEjY1RTVBNDkwMDBBRjQ1OTE5NQA=,2025-10-09T22:16:04.740Z,034523759
SEN. BANIGO IPALIBO HARRY,2347034130891,34130891,34130891,SUCCESS,wamid.HBgNMjM0NzAzNDEzMDg5MRUCABEYEkJFMzNFNzM4NkJGOTA3RkJEOAA=,2025-10-09T22:16:06.227Z,034130891
⁠SEN. ONYESOH ALLWEL HEACHO,2348132702338,132702338,132702338,SUCCESS,wamid.HBgNMjM0ODEzMjcwMjMzOBUCABEYEjQzRkI5MEMwQkM3QUIxRjQ2NQA=,2025-10-09T22:16:07.721Z,132702338
SEN. IBRAHIM LAMIDO,2348144141494,144141494,144141494,SUCCESS,wamid.HBgNMjM0ODE0NDE0MTQ5NBUCABEYEjQ3MjNFMzhCQzhGQ0IyNTY4MQA=,2025-10-09T22:16:10.363Z,144141494
SEN. MANU HARUNA,2348033279720,33279720,33279720,SUCCESS,wamid.HBgNMjM0ODAzMzI3OTcyMBUCABEYEjU5MjM3MzUyQkNGMUJCMUMyOAA=,2025-10-09T22:16:12.104Z,033279720
SEN. DAVID S. U. JIMKUTA,2349025555594,25555594,25555594,SUCCESS,wamid.HBgNMjM0OTAyNTU1NTU5NBUCABEYEjU5RTIzNzFGNjBFODU0NTk3OQA=,2025-10-09T22:16:13.663Z,025555594
SEN. MOHAMMED BOMAI IBRAHIM,2348036947461,36947461,36947461,SUCCESS,wamid.HBgNMjM0ODAzNjk0NzQ2MRUCABEYEjUzRDUxOTUyN0E3RTgyNzA0NwA=,2025-10-09T22:16:15.365Z,036947461
SEN. ABUBAKAR ABDULAZIZ YARI,2349074155333,74155333,74155333,SUCCESS,wamid.HBgNMjM0OTA3NDE1NTMzMxUCABEYEjdFMTIwMjBENDJBRTI1NUI2QQA=,2025-10-09T22:16:16.904Z,074155333
SEN. YAU SAHABI ALHAJI,2347034777772,34777772,34777772,SUCCESS,wamid.HBgNMjM0NzAzNDc3Nzc3MhUCABEYEjk3NDI1MjAwQ0E0MDYwODFBNwA=,2025-10-09T22:16:18.351Z,034777772
⁠SEN. KINGIBE IRETI HEEBAH,2348099900099,99900099,99900099,SUCCESS,wamid.HBgNMjM0ODA5OTkwMDA5ORUCABEYEjU2ODVCMTJDOTYxODExNUJGNgA=,2025-10-09T22:16:19.953Z,099900099
`,
                    
                    // Hardcoded log data - replace with your actual log content
                    hardcodedLog: ``
                };
            },
            async mounted() {
                await this.getWebLog();
                // Auto-load hardcoded data
                await this.loadHardcodedData();
            },
            computed: {
                filteredResults() {
                    if (!this.searchQuery) return this.results;

                    const query = this.searchQuery.toLowerCase();
                    return this.results.filter(result =>
                        result.name.toLowerCase().includes(query) ||
                        result.phone.toLowerCase().includes(query) ||
                        result.messageId.toLowerCase().includes(query) ||
                        result.status.toLowerCase().includes(query)
                    );
                },
                statusCounts() {
                    const counts = {
                        read: 0,
                        delivered: 0,
                        sent: 0,
                        failed: 0,
                        unknown: 0
                    };

                    this.results.forEach(result => {
                        const status = result.status.toLowerCase();
                        if (counts.hasOwnProperty(status)) {
                            counts[status]++;
                        }
                    });

                    return counts;
                }
            },
            methods: {
                async getWebLog() {
                    try {
                        // Fetch log
                        const logResponse = await fetch('https://proctoredserver.peppubuild.com/logs');
                        const logText = await logResponse.text();
                        this.hardcodedLog = logText;
                        // Process them...
                    } catch (error) {
                        console.error('Error loading files:', error);
                    }
                },
                async loadHardcodedData() {
                    try {
                        this.processing = true;
                        console.log('Loading hardcoded data...');

                        // Parse hardcoded CSV
                        Papa.parse(this.hardcodedCSV, {
                            header: true,
                            skipEmptyLines: true,
                            complete: (results) => {
                                this.csvData = results.data;
                                console.log('CSV loaded:', this.csvData.length, 'records');
                            },
                            error: (error) => {
                                throw new Error('Error parsing CSV: ' + error.message);
                            }
                        });

                        // Parse hardcoded log
                        this.logData = this.parseLogFile(this.hardcodedLog);
                        console.log('Log loaded:', Object.keys(this.logData).length, 'message IDs');

                        // Auto-process if both loaded
                        if (this.csvData && this.logData) {
                            setTimeout(() => this.processData(), 500);
                        }

                        this.processing = false;
                    } catch (error) {
                        this.error = 'Could not load hardcoded data: ' + error.message;
                        console.error('Error loading data:', error);
                        this.processing = false;
                    }
                },

                async loadFilesFromRoot() {
                    try {
                        this.processing = true;
                        console.log('Fetching files from server...');

                        // Fetch CSV file
                        const csvResponse = await fetch('https://proctoredserver.peppubuild.com/chiaka-update.csv');
                        if (!csvResponse.ok) throw new Error(`CSV fetch failed: ${csvResponse.status}`);
                        const csvText = await csvResponse.text();

                        Papa.parse(csvText, {
                            header: true,
                            skipEmptyLines: true,
                            complete: (results) => {
                                this.csvData = results.data;
                                console.log('CSV loaded from server:', this.csvData.length, 'records');
                            },
                            error: (error) => {
                                throw new Error('Error parsing CSV: ' + error.message);
                            }
                        });

                        // Fetch log file
                        const logResponse = await fetch('https://proctoredserver.peppubuild.com/webhook.log');
                        if (!logResponse.ok) throw new Error(`Log fetch failed: ${logResponse.status}`);
                        const logText = await logResponse.text();
                        this.logData = this.parseLogFile(logText);
                        console.log('Log loaded from server:', Object.keys(this.logData).length, 'message IDs');

                        // Auto-process if both files loaded
                        if (this.csvData && this.logData) {
                            setTimeout(() => this.processData(), 500);
                        }

                        this.processing = false;
                    } catch (error) {
                        this.error = 'Could not load files from server: ' + error.message;
                        console.error('Error loading files:', error);
                        this.processing = false;
                    }
                },
                handleCSVUpload(event) {
                    const file = event.target.files[0];
                    if (!file) return;

                    this.error = null;
                    const reader = new FileReader();

                    reader.onload = (e) => {
                        Papa.parse(e.target.result, {
                            header: true,
                            skipEmptyLines: true,
                            complete: (results) => {
                                this.csvData = results.data;
                                console.log('CSV loaded:', this.csvData.length, 'records');
                            },
                            error: (error) => {
                                this.error = 'Error parsing CSV: ' + error.message;
                            }
                        });
                    };

                    reader.readAsText(file);
                },

                handleLogUpload(event) {
                    const file = event.target.files[0];
                    if (!file) return;

                    this.error = null;
                    const reader = new FileReader();

                    reader.onload = (e) => {
                        try {
                            const content = e.target.result;
                            this.logData = this.parseLogFile(content);
                            console.log('Log loaded:', Object.keys(this.logData).length, 'message IDs');
                        } catch (error) {
                            this.error = 'Error parsing log file: ' + error.message;
                        }
                    };

                    reader.readAsText(file);
                },

                parseLogFile(content) {
                    const statusMap = {};
                    const lines = content.split('\n');

                    // Regex to extract message ID and status
                    // Pattern: [timestamp] 📩 Message <messageId> to <phone> is now <status>
                    const pattern = /Message\s+(wamid\.[^\s]+)\s+to\s+\d+\s+is\s+now\s+(\w+)/;

                    lines.forEach(line => {
                        const match = line.match(pattern);
                        if (match) {
                            const messageId = match[1];
                            const status = match[2];
                            statusMap[messageId] = status;
                        }
                    });

                    return statusMap;
                },

                processData() {
                    if (!this.csvData || !this.logData) {
                        this.error = 'Please upload both CSV and log files';
                        return;
                    }

                    this.processing = true;
                    this.error = null;
                    this.results = [];

                    setTimeout(() => {
                        try {
                            console.log('CSV Data sample:', this.csvData[0]);
                            console.log('CSV columns:', Object.keys(this.csvData[0]));
                            console.log('Log Data sample:', Object.keys(this.logData).slice(0, 3));

                            this.csvData.forEach((row, index) => {
                                // Try multiple variations of column names
                                const name = row.name || row.Name || row.NAME ||
                                    row['Name'] || row['name'] || '';
                                const phone = row.phone || row.Phone || row.PHONE ||
                                    row['Phone'] || row['phone'] || '';
                                const messageId = row.messageId || row.MessageId || row.messageid ||
                                    row.MESSAGEID || row.message_id || row.MessageID ||
                                    row['messageId'] || row['MessageId'] || row['message_id'] || '';


                                if (!messageId) {
                                    console.warn(`Row ${index} has no messageId`);
                                    return;
                                }

                                const status = this.logData[messageId] || 'Unknown';

                                this.results.push({
                                    name: name.trim(),
                                    phone: phone.trim(),
                                    messageId: messageId.trim(),
                                    status: status.charAt(0).toUpperCase() + status.slice(1).toLowerCase()
                                });
                            });

                            console.log('Processing complete:', this.results.length, 'results');

                            if (this.results.length === 0) {
                                this.error = 'No results generated. Check console for debugging info. Make sure your CSV has columns: name, phone, and messageId';
                            }
                        } catch (error) {
                            this.error = 'Error processing data: ' + error.message;
                            console.error('Processing error:', error);
                        } finally {
                            this.processing = false;
                        }
                    }, 100);
                }
            }
        }).mount('#app');
    </script>
</body>
</html>