<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Guest List Manager - Vue (fixed)</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <style>
    /* (same styling as before) */
    body { background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; padding:20px 0; }
    .container-main { max-width:1200px; margin:0 auto; }
    .card { border:none; box-shadow:0 10px 30px rgba(0,0,0,0.2); border-radius:12px; overflow:hidden; }
    .card-header { background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:25px; border:none; }
    .card-title { margin:0; font-size:28px; font-weight:600; }
    .btn-primary { background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); border:none; }
    .btn-primary:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(102,126,234,0.4); }
    .dropdown-menu { border-radius:8px; border:none; box-shadow:0 5px 15px rgba(0,0,0,0.15); }
    .dropdown-item:hover { background-color:#f8f9fa; color:#667eea; }
    .form-control:focus { border-color:#667eea; box-shadow:0 0 0 0.2rem rgba(102,126,234,0.25); }
    .table thead { background-color:#f8f9fa; border-bottom:2px solid #e0e0e0; }
    .table th { color:#667eea; font-weight:600; }
    .btn-delete { background-color:#ff6b6b; border:none; color:white; padding:6px 12px; border-radius:6px; cursor:pointer; }
    .btn-delete:hover { background-color:#ff5252; transform:scale(1.05); }
    .btn-invite { background-color:#764ba2; border:none; color:white; padding:6px 12px; border-radius:6px; cursor:pointer; margin: 2px}
    .empty-state { text-align:center; padding:40px 20px; color:#999; }
    .empty-state-icon { font-size:48px; margin-bottom:15px; opacity:0.5; }
    .btn-success { background: linear-gradient(135deg,#11998e 0%,#38ef7d 100%); border:none; }
    .btn-success:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(17,153,142,0.4); }
  </style>
</head>
<body>
  <div id="app" class="container-main">
    <div class="card">
      <div class="card-header">
        <h1 class="card-title">ðŸ“‹ Guest List Manager</h1>
      </div>
      <div class="card-body">

        <!-- Import Section -->
        <div class="btn-group-import mb-4">
          <div class="dropdown">
            <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
              + Import Guest List
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" @click="openSingleModal">Add Single Guest</a></li>
              <li><a class="dropdown-item" @click="openMultipleModal">Add Multiple Guests</a></li>
            </ul>
          </div>
        </div>

        <!-- Success Alert -->
        <div v-if="successMessage" class="alert alert-info alert-dismissible fade show" role="alert">
          {{ successMessage }}
          <button type="button" class="btn-close" @click="successMessage=''" aria-label="Close"></button>
        </div>

        <!-- Guest Table -->
        <div v-if="guests.length" class="table-container">
          <table class="table table-hover">
            <thead>
              <tr>
                <th style="width:3%">#</th>
                <th style="width:25%">Name</th>
                <th style="width:20%">Email</th>
                <th style="width:15%">Number</th>
                <th style="width:5%">Guest-Count</th>
                <th style="width:15%">Invitation Status</th>
                <th style="width:17%">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(guest,index) in guests" :key="index">
                <td>{{ index + 1 }}</td>
                <td>{{ guest.name }}</td>
                <td>{{ guest.email }}</td>
                <td>{{ guest.number }}</td>
                <td>{{ guest.count ? guest.count : 'N/A' }}</td>
                <td>{{ guest.invitation ? guest.invitation : 'N/A' }}</td>
                <td>
                  <button class="btn-delete" @click="deleteGuest(index)">Delete</button>
                  <button class="btn-invite" @click="deleteGuest(index)">Invite</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Empty State -->
        <div v-else class="empty-state">
          <div class="empty-state-icon">ðŸ‘¥</div>
          <p>No guests added yet. Click "Import Guest List" to get started!</p>
        </div>

      </div>
    </div>

    <!-- Single Guest Modal -->
    <div class="modal fade" id="singleGuestModal" tabindex="-1" ref="singleModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Single Guest</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Name *</label>
              <input v-model="singleGuest.name" type="text" class="form-control" placeholder="Enter guest name">
            </div>
            <div class="mb-3">
              <label class="form-label">Email *</label>
              <input v-model="singleGuest.email" type="email" class="form-control" placeholder="Enter guest email">
            </div>
            <div class="mb-3">
              <label class="form-label">Phone Number *</label>
              <input v-model="singleGuest.number" type="tel" class="form-control" placeholder="Enter guest phone">
            </div>
            <div class="d-flex gap-2">
              <button type="button" class="btn btn-success flex-grow-1" @click="addSingleGuest">Add Guest</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Multiple Guests Modal -->
    <div class="modal fade" id="multipleGuestsModal" tabindex="-1" ref="multipleModal">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Multiple Guests</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p class="text-muted mb-3">Enter guest details in CSV format (Name, Email, Phone Number). One guest per line.</p>
            <div class="mb-3">
              <label class="form-label">Guest List (CSV Format) *</label>
              <textarea v-model="multipleGuestsText" class="form-control" rows="8" placeholder="John Doe,john@example.com,1234567890&#10;Jane Smith,jane@example.com,0987654321"></textarea>
              <small class="text-muted">Format: Name, Email, Phone Number</small>
            </div>
            <div class="d-flex gap-2">
              <button type="button" class="btn btn-success flex-grow-1" @click="addMultipleGuests">Add Guests</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

  <script>
    const { createApp, ref, onMounted } = Vue; // <-- onMounted added

    createApp({
      setup() {
        const guests = ref([]);
        const successMessage = ref('');
        const singleGuest = ref({ name: '', email: '', number: '' });
        const multipleGuestsText = ref('');
        const singleModal = ref(null);
        const multipleModal = ref(null);

        // Bootstrap modal instances
        let singleModalInstance = null;
        let multipleModalInstance = null;

        const openSingleModal = () => {
          singleGuest.value = { name: '', email: '', number: '' };
          if (singleModalInstance) singleModalInstance.show();
        };

        const openMultipleModal = () => {
          multipleGuestsText.value = '';
          if (multipleModalInstance) multipleModalInstance.show();
        };

        const addSingleGuest = () => {
          const { name, email, number } = singleGuest.value;
          if (!name || !email || !number) {
            alert('Please fill in all fields');
            return;
          }
          guests.value.push({ name, email, number });
          if (singleModalInstance) singleModalInstance.hide();
          showSuccess(1);
        };

        const addMultipleGuests = () => {
          const lines = multipleGuestsText.value.trim().split('\n').filter(l => l.trim());
          let added = 0;
          lines.forEach(line => {
            const parts = line.split(',').map(p => p.trim());
            if (parts.length === 3 && parts[0] && parts[1] && parts[2]) {
              guests.value.push({ name: parts[0], email: parts[1], number: parts[2] });
              added++;
            }
          });
          if (added > 0) {
            if (multipleModalInstance) multipleModalInstance.hide();
            showSuccess(added);
          } else {
            alert('No valid guests found. Please check the format.');
          }
        };

        const deleteGuest = (index) => {
          if (confirm('Are you sure you want to delete this guest?')) {
            guests.value.splice(index, 1);
          }
        };

        const showSuccess = (count) => {
          successMessage.value = `âœ“ Successfully added ${count} guest(s)`;
          setTimeout(() => successMessage.value = '', 4000);
        };

        // Initialize bootstrap modal instances when component mounts
        onMounted(() => {
          // make sure refs are present
          if (singleModal.value) {
            singleModalInstance = new bootstrap.Modal(singleModal.value);
          }
          if (multipleModal.value) {
            multipleModalInstance = new bootstrap.Modal(multipleModal.value);
          }
        });

        return {
          guests,
          successMessage,
          singleGuest,
          multipleGuestsText,
          singleModal,
          multipleModal,
          openSingleModal,
          openMultipleModal,
          addSingleGuest,
          addMultipleGuests,
          deleteGuest
        };
      }
    }).mount('#app');
  </script>
</body>
</html>
